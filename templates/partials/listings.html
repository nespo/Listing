{% load humanize %}

{% for listing in listings %}
<div class="listing-box" id="listing-{{ listing.id|safe }}">
    {% if listing.is_featured %}
    <div class="featured">Featured</div>
    {% endif %}
    <div class="listing-thumbnail-image">
        <a href="{% url 'listing_detail' listing.slug %}" class="listing-popup-link">
            {% if listing.thumbnail_image %}
            <img src="{{ listing.thumbnail_image.url }}" alt="Image for {{ listing.project_name|safe }}">
            {% else %}
            <img src="https://www.contentviewspro.com/wp-content/uploads/2017/07/default_image.png" alt="Default image">
            {% endif %}
        </a>
    </div>
    <p><i class="fa fa-map-marker-alt" aria-hidden="true"></i> {{ listing.project_address|safe }}</p>
    <h2>{{ listing.project_name|safe }}</h2>
    <div class="listing-bottom">
        <p class="price">Price: {{ listing.sales_price|floatformat:0|intcomma }}</p> <!-- Ensure decimal is properly formatted and then apply intcomma -->
        <a href="{% url 'listing_detail' listing.slug %}" class="view-details-btn">View Details</a>
    </div>
</div>
{% endfor %}
