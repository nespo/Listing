{% extends 'base.html' %}
{% load static %}
{% block title %}Available Packages{% endblock %}
{% block extra_css %}
<link rel="stylesheet" type="text/css" href="{% static 'Public_package/styles.css' %}">
{% endblock %}
{% block content %}
<section class="plans__container">
    <div class="plans">
        <div class="plansHero">
            <h1 class="plansHero__title">Simple, Transparent Pricing</h1>
            <p class="plansHero__subtitle">No contracts. No surprise fees.</p>
        </div>
        <div class="package-container">
            <div class="available-packages">
                <h2 class="available-packages__title" style="color: #fff !important;">Available Memberships</h2>
                <div class="packages-grid">
                    {% for package in packages %}
                    <div class="planItem">
                        <div class="card">
                            <div class="card__top-bar"></div>
                            <div class="package-type">
                                <p class="floating-text"><i class="fas fa-cube"></i> Membership Type: {{ package.get_duration_unit_display }}</p>
                            </div>
                            <h2>{{ package.name }}</h2>
                            <div class="card__desc">
                                <p><i class="fas fa-thumbtack"></i> Normal Posts: {{ package.normal_post_limit }}</p>
                                <p><i class="fas fa-star"></i> Featured Posts: {{ package.featured_post_limit }}</p>
                                <p><i class="fas fa-dollar-sign"></i> Price: ${{ package.price }}</p>
                            </div>
                            <button type="button" class="button package-button full-width-button" onclick="showSignUpForm()">Buy Membership</button>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <div class="faq-container">
            <div class="faq__top-bar"></div>
            <h2 class="faq-title">Frequently Asked Questions</h2>
            <ul class="faq-list">
                {% for faq in faqs %}
                <li class="faq-item">
                    <h3 class="faq-question">{{ faq.question }} <i class="faq-toggle-icon fas fa-chevron-down"></i></h3>
                    <div class="faq-answer">{{ faq.answer|safe }}</div>
                </li>
                {% endfor %}
            </ul>
        </div>
    </div>
</section>
{% endblock %}
{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        function showSignUpForm() {
            var signupPopup = document.getElementById('signup-popup');
            if (signupPopup) {
                signupPopup.style.display = 'block';
            } else {
                console.error('Signup popup not found');
            }
        }

        var faqItems = document.querySelectorAll('.faq-item');
        console.log('FAQ Items:', faqItems);
        faqItems.forEach(function(item) {
            var question = item.querySelector('.faq-question');
            console.log('FAQ Question:', question);
            question.addEventListener('click', function() {
                var currentlyActive = document.querySelector('.faq-answer.active');
                if (currentlyActive && currentlyActive !== item.querySelector('.faq-answer')) {
                    currentlyActive.classList.remove('active');
                    currentlyActive.style.maxHeight = null;
                    currentlyActive.previousElementSibling.querySelector('.faq-toggle-icon').classList.remove('fa-chevron-up');
                    currentlyActive.previousElementSibling.querySelector('.faq-toggle-icon').classList.add('fa-chevron-down');
                }
                var answer = item.querySelector('.faq-answer');
                console.log('FAQ Answer:', answer);
                if (answer.classList.contains('active')) {
                    answer.classList.remove('active');
                    answer.style.maxHeight = null;
                    question.querySelector('.faq-toggle-icon').classList.remove('fa-chevron-up');
                    question.querySelector('.faq-toggle-icon').classList.add('fa-chevron-down');
                } else {
                    answer.classList.add('active');
                    answer.style.maxHeight = answer.scrollHeight + 'px';
                    question.querySelector('.faq-toggle-icon').classList.remove('fa-chevron-down');
                    question.querySelector('.faq-toggle-icon').classList.add('fa-chevron-up');
                }
                console.log('Answer maxHeight:', answer.style.maxHeight);
            });
        });

        window.showSignUpForm = showSignUpForm;
    });
</script>
{% endblock %}
